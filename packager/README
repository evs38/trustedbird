== Build Documentation ==
=== Dependencies ===
==== Linux (Debian) ====
* build-essential
* ant
* subversion
* libgtk2.0-dev
* libglib1.2-dev
* libidl-dev
* libxt-dev
* zip
* unzip
* flex
* bison
* fakeroot
* dpkg-deb
* python-dev
* autoconf
* libtool 
* a Java JDK for ant (java-gcj-compat-dev, sun-java6-jdk, openjdk-6-jdk,...)

==== Windows ====
* Microsoft Visual C++ 6 with Service Pack 5 (not Service Pack 6 because Processor Pack needs SP5)
* Visual C++ 6.0 Processor Pack
* Latest MozillaBuild
* Java JDK
* Ant
* Cygwin (for sed.exe and sha1sum.exe, used in Ant build script for add-ons)

See http://developer.mozilla.org/en/docs/Windows_Build_Prerequisites

* Add Ant path, Cygwin path and JDK path to the PATH variable in c:\mozilla-build\start-msvc6.bat:
    SET PATH=%PATH%;%MOZ_TOOLS%\bin;C:\mozilla-build\apache-ant-1.8.0RC1-bin\bin;C:\cygwin\bin;C:\Program Files\Java\jdk1.6.0_18\bin
* Set JAVA_HOME as environment variable
* Launch build environment with c:\mozilla-build\start-msvc6.bat

=== Get build scripts/packager ===
==== Read only / through SVN protocol (TCP port 3690) ====
 $ svn co svn://svn.adullact.net/svnroot/milimail/trunk/packager trustedbird

==== Read-write / through SSH (TCP port 22) ====
 $ svn co svn+ssh://my_username@svn.adullact.net/svnroot/milimail/trunk/packager trustedbird
   (replace my_username by your Adullact SSH username)

  // Copy the file server.properties.template to server.properties
 $ cp trustedbird/server.properties.template trustedbird/server.properties

  // Set your SSH username in server.properties
 $ sed -i s/SSH_USERNAME/my_username/ trustedbird/server.properties
   (replace my_username by your Adullact SSH username)

=== Building ===
 $ cd trustedbird

  // Build and package Trustedbird and add-ons
 $ ant build-all

  // OR: build and package trustedbird
 $ ant extract-tb update-tb build-tb package-tb

  // OR: build and package add-ons
 $ ant package-addons

=== Signed updates (optional) ===
Generate a public key from McCoy and put it in a new "updateKey" file in same folder as build.xml.
It will be automatically inserted in install.rdf file of all add-ons.

In order to use trustedbird.org key, copy "updateKey-trustedbird.org" file to "updateKey".

Next, using McCoy, sign all dist/updates/*/update.rdf before publishing them.
